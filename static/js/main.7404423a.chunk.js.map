{"version":3,"sources":["App.js","jsm/webxr/ARButton.js","index.js"],"names":["container","camera","scene","renderer","reticle","current_object","controls","shadow_plane","groupModel","touchDown","touchX","touchY","deltaX","arToolkitSource","ARButton","sessionInit","button","document","createElement","showStartAR","currentSession","onSessionStarted","session","addEventListener","onSessionEnded","xr","setReferenceSpaceType","setSession","textContent","removeEventListener","style","display","cursor","right","width","backgroundColor","onmouseenter","opacity","onmouseleave","onclick","navigator","requestSession","then","end","disableButton","showARNotSupported","stylizeElement","element","position","bottom","padding","border","borderRadius","background","color","font","textAlign","outline","zIndex","id","isSessionSupported","supported","catch","message","window","isSecureContext","href","location","replace","innerHTML","left","textDecoration","hitTestSource","hitTestSourceRequested","enableUI","App","useState","mode","showIntro","setShowIntro","arPlaceObject","visible","setFromMatrixPosition","matrix","onWindowResize","aspect","innerWidth","innerHeight","updateProjectionMatrix","setSize","loadModel","url","remove","getElementById","GLTFLoader","setPath","load","gltf","traverse","node","isMesh","castShadow","geometry","THREE","rotateX","Math","PI","material","depthWrite","receiveShadow","add","box","setFromObject","getCenter","target","update","render","animateBasic","requestAnimationFrame","ready","arToolkitContext","domElement","timestamp","frame","referenceSpace","getReferenceSpace","getSession","requestReferenceSpace","requestHitTestSource","space","source","hitTestResults","getHitTestResults","length","hit","fromArray","getPose","transform","useEffect","console","log","directionalLight","set","shadow","top","ambientLight","createLighting","antialias","alpha","setClearColor","setPixelRatio","devicePixelRatio","outputEncoding","shadowMap","enabled","type","appendChild","OrbitControls","minDistance","maxDistance","options","requiredFeatures","optionalFeatures","domOverlay","root","body","createButton","addARButton","matrixAutoUpdate","rotateObject","rotation","y","e","preventDefault","touches","pageX","pageY","addRotateModel","setAnimationLoop","height","overflow","className","onClick","fontSize","hideButton","scale","x","z","ReactDOM","Fragment"],"mappings":"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","file":"static/js/main.7404423a.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport * as THREE from \"three\";\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader.js';\r\nimport { RoughnessMipmapper } from 'three/examples/jsm/utils/RoughnessMipmapper.js';\r\nimport './loader.css';\r\nimport { ARButton } from './jsm/webxr/ARButton';\r\n// import './jsartoolkit5/artoolkit.api';\r\n// import './jsartoolkit5/artoolkit.min.js';\r\n// import './threex/threex-artoolkitsource';\r\n// import './threex/threex-artoolkitcontext';\r\n// import './threex/threex-arbasecontrols';\r\n// import './threex/threex-armarkercontrols';\r\n\r\n/**\r\n * nén file gltf:\r\n * dùng flag -d khi convert\r\n * https://github.com/CesiumGS/gltf-pipeline\r\n */\r\n\r\nlet container;\r\nlet camera, scene, renderer;\r\n\r\nlet reticle, current_object, controls, shadow_plane, groupModel;\r\n\r\nlet hitTestSource = null;\r\nlet hitTestSourceRequested = false;\r\nlet enableUI = true;\r\n\r\nlet touchDown, touchX, touchY, deltaX, deltaY;\r\n\r\nlet arToolkitSource, arToolkitContext;\r\nlet markerRoot1, markerRoot2;\r\n\r\n// const pathModel = 'ar-with-react/3d/'; // local\r\nconst pathModel = '3d/'; // build\r\n\r\nconst App = () => {\r\n    const [mode, setMode] = useState(1); \r\n    const [showIntro, setShowIntro] = useState(true);\r\n    /**\r\n     * 0: arToolkit enable, detect marker\r\n     * 1: detect plane\r\n     */\r\n\r\n    useEffect(() => {\r\n        console.log('new update 13');\r\n        init();\r\n        // \r\n        switch (mode) {\r\n            case 0:\r\n                animateBasic();\r\n                break;\r\n            case 1:\r\n                animateWithXR();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }, [])\r\n    \r\n    //////////////////////////////////////////\r\n    // Document Event  ///////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function openNav(e) {\r\n        e.preventDefault();\r\n        document.getElementById(\"mySidenav\").style.width = \"250px\";\r\n    }\r\n\r\n    function closeNav(e) {\r\n        e.preventDefault();\r\n        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n    }\r\n\r\n    function arPlaceObject() {\r\n        if (reticle.visible) {\r\n            groupModel.position.setFromMatrixPosition(reticle.matrix);\r\n            groupModel.visible = true;\r\n        }\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Init Scene ////////////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function createCamera () {\r\n        camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.001, 200);\r\n    }\r\n\r\n    function createRenderer () {\r\n        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\n        // , logarithmicDepthBuffer: true \r\n        renderer.setClearColor(new THREE.Color('lightgrey'), 0);\r\n        renderer.setPixelRatio(window.devicePixelRatio);\r\n        renderer.setSize(window.innerWidth, window.innerHeight);\r\n        // THREE.GammaEncoding // fix object model too dark\r\n        renderer.outputEncoding = THREE.sRGBEncoding; // fix object model too dark\r\n        // renderer.gammaFactor = 2.2;\r\n        renderer.shadowMap.enabled = true;\r\n        renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        // renderer.shadowMap.type = THREE.PCFShadowMap;\r\n        if(mode === 1) {\r\n            renderer.xr.enabled = true;\r\n        }\r\n        \r\n        container.appendChild(renderer.domElement);\r\n    }\r\n\r\n    function createLighting () {\r\n        var directionalLight = new THREE.DirectionalLight(0xdddddd, 0.5);\r\n        directionalLight.position.set(0, 5, -1);\r\n        // thu hẹp camera lại càng ít (> 0) thì shadow sẽ càng sharp hơn.\r\n        directionalLight.shadow.camera.left = -1;\r\n        directionalLight.shadow.camera.right = 1;\r\n        directionalLight.shadow.camera.top = -1;\r\n        directionalLight.shadow.camera.bottom = 1;\r\n        directionalLight.castShadow = true;\r\n        scene.add(directionalLight);\r\n\r\n        var ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\r\n        // ambientLight.position.set(0, 2, -1);\r\n        scene.add(ambientLight);\r\n\r\n        // const helper = new THREE.CameraHelper( directionalLight.shadow.camera );\r\n        // scene.add( helper );\r\n    }\r\n\r\n    function createControl () {\r\n        controls = new OrbitControls(camera, renderer.domElement);\r\n        controls.addEventListener('change', render);\r\n\r\n        controls.minDistance = 2;\r\n        controls.maxDistance = 10;\r\n        controls.target.set(0, 0, 0);\r\n    }\r\n\r\n    function addARButton () {\r\n        var options = {\r\n            requiredFeatures: ['hit-test'],\r\n            optionalFeatures: ['dom-overlay']\r\n        }\r\n\r\n        options.domOverlay = { root: document.getElementById('ui-content') };\r\n        document.body.appendChild(ARButton.createButton(renderer, options));\r\n    }\r\n\r\n    function addReticle () { // ring cursor for detection\r\n        reticle = new THREE.Mesh(\r\n            new THREE.RingBufferGeometry(0.015, 0.02, 32).rotateX(- Math.PI / 2),\r\n            new THREE.MeshBasicMaterial()\r\n        );\r\n        reticle.matrixAutoUpdate = false;\r\n        reticle.visible = false;\r\n        scene.add(reticle);\r\n    }\r\n\r\n    function arToolkitSourceSetup () {\r\n        // arToolkitSource = new THREEx.ArToolkitSource({\r\n        //     sourceType : 'webcam',\r\n        // });\r\n    \r\n        // arToolkitSource.init(function onReady(){\r\n        //     onWindowResize()\r\n        // });\r\n    }\r\n\r\n    function init() {\r\n        container = document.getElementById('container');\r\n        scene = new THREE.Scene();\r\n\r\n        createCamera();\r\n        createLighting();\r\n        createRenderer();\r\n        createControl();\r\n\r\n        addARButton();\r\n        addReticle();\r\n\r\n        addRotateModel();\r\n        // arToolkitSourceSetup();\r\n\r\n        window.addEventListener('resize', onWindowResize, false);\r\n\r\n        document.getElementById('ARButton').addEventListener('click', function () {\r\n\t\t\tif(groupModel) groupModel.visible = false;\r\n        })\r\n    }\r\n\r\n    function onWindowResize() {\r\n\r\n        camera.aspect = window.innerWidth / window.innerHeight;\r\n        camera.updateProjectionMatrix();\r\n\r\n        renderer.setSize(window.innerWidth, window.innerHeight);\r\n\r\n        // if(arToolkitSource) {\r\n        //     arToolkitSource.onResize()\t\r\n        //     arToolkitSource.copySizeTo(renderer.domElement)\t\r\n        //     if ( arToolkitContext.arController !== null )\r\n        //     {\r\n        //         arToolkitSource.copySizeTo(arToolkitContext.arController.canvas)\t\r\n        //     }\r\n        // }\r\n\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Model handling ////////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function loadModel(url) {\r\n        if (groupModel) {\r\n            scene.remove(groupModel);\r\n        }\r\n\r\n        document.getElementById('loader-model').style.display = 'block';\r\n        new GLTFLoader()\r\n            .setPath(pathModel) // path luôn được xác định từ folder chứa index.html\r\n            .load(url, function (gltf) {\r\n                current_object = gltf.scene;\r\n\r\n                // console.log(current_object.children[0].children);\r\n                // current_object.children[0].children[0].material.metalness = 0;\r\n                // current_object.children[0].children[1].material.metalness = 0;\r\n\r\n                current_object.traverse(function (node) { // cast shadow trên từng thành phần của model\r\n                    if ( node.isMesh ) { \r\n                        node.castShadow = true;\r\n                    }\r\n                })\r\n\r\n                let geometry = new THREE.PlaneBufferGeometry(20, 20);\r\n                geometry.rotateX( - Math.PI / 2 );\r\n                let material = new THREE.ShadowMaterial({ color: 0x000000 });\r\n                material.opacity = 0.5;\r\n                material.depthWrite = false;\r\n                shadow_plane = new THREE.Mesh(geometry, material);\r\n                shadow_plane.receiveShadow = true;\r\n\r\n                groupModel = new THREE.Group();\r\n                groupModel.add(current_object);\r\n                groupModel.add(shadow_plane);\r\n\r\n                scene.add(groupModel);\r\n\r\n                var box = new THREE.Box3();\r\n                box.setFromObject(groupModel);\r\n                box.getCenter(controls.target);\r\n                arPlaceObject();\r\n\r\n                document.getElementById('loader-model').style.display = 'none';\r\n                document.getElementById('ARButton').style.display = 'block';\r\n\r\n                controls.update();\r\n                \r\n                setShowIntro(false);\r\n                render();\r\n            });\r\n    }\r\n\r\n    function addRotateModel () {\r\n        renderer.domElement.addEventListener('touchstart', function (e) {\r\n            e.preventDefault();\r\n            touchDown = true;\r\n            touchX = e.touches[0].pageX;\r\n            touchY = e.touches[0].pageY;\r\n        }, false)\r\n        renderer.domElement.addEventListener('touchend', function (e) {\r\n            e.preventDefault();\r\n            touchDown = false;\r\n        }, false)\r\n        renderer.domElement.addEventListener('touchmove', function (e) {\r\n            e.preventDefault();\r\n\r\n            if (!touchDown) return;\r\n\r\n            deltaX = e.touches[0].pageX - touchX;\r\n            deltaY = e.touches[0].pageY - touchY;\r\n            touchX = e.touches[0].pageX;\r\n            touchY = e.touches[0].pageY;\r\n\r\n            rotateObject();\r\n        }, false)\r\n\r\n        function rotateObject() {\r\n            if (groupModel && reticle && hitTestSource) {\r\n                groupModel.rotation.y += deltaX / 100;\r\n            }\r\n        }\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Update and Animate ////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function animateBasic () {\r\n        requestAnimationFrame(animateBasic);\r\n        if ( arToolkitSource.ready !== false )\r\n            arToolkitContext.update( arToolkitSource.domElement );\r\n        \r\n        render(); // not pass param in order to render normally.\r\n    }\r\n\r\n    function animateWithXR() {\r\n        renderer.setAnimationLoop(render);\r\n    }\r\n\r\n    function render(timestamp, frame) {\r\n        // if has param, it's used with XR, otherwise, it renders normally.\r\n        if (frame) {\r\n            const referenceSpace = renderer.xr.getReferenceSpace();\r\n            const session = renderer.xr.getSession();\r\n\r\n            if (hitTestSourceRequested === false) {\r\n                session.requestReferenceSpace('viewer').then(function (referenceSpace) {\r\n                    session.requestHitTestSource({ space: referenceSpace }).then(function (source) {\r\n                        hitTestSource = source;\r\n                    });\r\n                });\r\n\r\n                session.addEventListener('end', function () {\r\n                    hitTestSourceRequested = false;\r\n                    hitTestSource = null;\r\n\r\n                    reticle.visible = false;\r\n                    var box = new THREE.Box3();\r\n                    box.setFromObject(groupModel);\r\n                    box.getCenter(controls.target);\r\n\r\n                    document.getElementById('place-button').style.display = 'none';\r\n                    document.getElementById('group-zoom').style.display = 'none';\r\n\r\n                });\r\n                hitTestSourceRequested = true;\r\n            }\r\n\r\n            if (hitTestSource) {\r\n                const hitTestResults = frame.getHitTestResults(hitTestSource);\r\n                if (hitTestResults.length) {\r\n                    const hit = hitTestResults[0];\r\n                    document.getElementById('group-zoom').style.display = 'block';\r\n                    if(enableUI) {\r\n                        document.getElementById('place-button').style.display = 'block';\r\n                        document.getElementById('zoom-in-button').style.display = 'block';\r\n                        document.getElementById('zoom-out-button').style.display = 'block';\r\n                        reticle.visible = true;\r\n                    }\r\n                    else{\r\n                        document.getElementById('place-button').style.display = 'none';\r\n                        document.getElementById('zoom-in-button').style.display = 'none';\r\n                        document.getElementById('zoom-out-button').style.display = 'none';\r\n                        reticle.visible = false;\r\n                    }\r\n                    reticle.matrix.fromArray(hit.getPose(referenceSpace).transform.matrix);\r\n                } else {\r\n                    document.getElementById('place-button').style.display = 'none';\r\n                    document.getElementById('zoom-in-button').style.display = 'none';\r\n                    document.getElementById('zoom-out-button').style.display = 'none';\r\n                    reticle.visible = false;\r\n                }\r\n            }\r\n        }\r\n        renderer.render(scene, camera);\r\n    }\r\n\r\n    return (\r\n        <div style={{ width: '100%', height: '100%', overflow: 'hidden' }}>\r\n            <div className=\"wrap-intro\" style={{display: showIntro ? 'flex' : 'none'}}>\r\n                <p>Select an item then press \"Start XR\"</p>\r\n                <p>You need to scan the floor until a ring appears on your screen.</p>\r\n            </div>\r\n            <div id=\"ui-content\">\r\n                <div id=\"mySidenav\" className=\"sidenav\">\r\n                    <a href=\"#\" className=\"closebtn\" onClick={closeNav}>×</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('old_sofa_free.glb');\r\n                    }}>Sofa</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('eames_lounge_chair.gltf');\r\n                    }}>Lounge Chair</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('lamp.glb');\r\n                    }}>Lamp</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('antique_iron_safe_v2.glb');\r\n                    }}>Iron Safe</a>\r\n                    {/* <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('dancing_girl.gltf');\r\n                    }}>Dancing Girl</a> */}\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('vintage_telephone.gltf');\r\n                    }}>Telephone</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('wooden_chair_low_poly.glb');\r\n                    }}>Wooden Chair</a>\r\n                </div>\r\n                <span className=\"buttonMenu\" style={{ fontSize: '30px', cursor: 'pointer' }} onClick={openNav}>☰</span>\r\n                <button type=\"button\" id=\"place-button\" onClick={arPlaceObject}>PLACE</button>\r\n                <div id=\"group-zoom\">\r\n                    <button id=\"hide-button\" type=\"button\"\r\n                        onClick={() => {\r\n                            let hideButton = document.getElementById('hide-button');\r\n                            enableUI = !enableUI;\r\n                            if(enableUI) hideButton.innerHTML = 'Hide UI';\r\n                            else hideButton.innerHTML = 'Show UI';\r\n                        }}\r\n                    >Hide UI</button>\r\n                    <button id=\"zoom-in-button\" type=\"button\" \r\n                        onClick={() => {\r\n                            if(groupModel && reticle.visible) {\r\n                                groupModel.scale.x += 0.1;\r\n                                groupModel.scale.y += 0.1;\r\n                                groupModel.scale.z += 0.1;\r\n                            }\r\n                        }}\r\n                    >+</button>\r\n                    <button id=\"zoom-out-button\" type=\"button\"\r\n                        onClick={() => {\r\n                            if (groupModel && reticle.visible && groupModel.scale.x > 0.2 && groupModel.scale.y > 0.2 && groupModel.scale.z > 0.2) {\r\n                                groupModel.scale.x -= 0.1;\r\n                                groupModel.scale.y -= 0.1;\r\n                                groupModel.scale.z -= 0.1;\r\n                            }\r\n                        }}\r\n                    >-</button>\r\n                </div>\r\n                <div id=\"container\" style={{ position: 'fixed' }}>\r\n                </div>\r\n                <div id=\"loader-model\"><div className=\"lds-circle\"><div></div></div></div>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","class ARButton {\r\n\tstatic createButton( renderer, sessionInit = {} ) {\r\n\t\tconst button = document.createElement( 'button' );\r\n\t\tfunction showStartAR( /*device*/ ) {\r\n\t\t\tlet currentSession = null;\r\n\t\t\tfunction onSessionStarted( session ) {\r\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\r\n\t\t\t\trenderer.xr.setReferenceSpaceType( 'local' );\r\n\t\t\t\trenderer.xr.setSession( session );\r\n\t\t\t\tbutton.textContent = 'Stop XR';\r\n\t\t\t\tcurrentSession = session;\r\n\t\t\t}\r\n\r\n\t\t\tfunction onSessionEnded( /*event*/ ) {\r\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\r\n\t\t\t\tbutton.textContent = 'Start XR';\r\n\t\t\t\tcurrentSession = null;\r\n\t\t\t}\r\n\r\n\t\t\tbutton.style.display = 'none';\r\n\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\tbutton.style.right = '20px';\r\n\t\t\tbutton.style.width = '100px';\r\n\t\t\tbutton.style.backgroundColor = '#fff';\r\n\t\t\tbutton.textContent = 'Start XR';\r\n\t\t\tbutton.onmouseenter = function () {\r\n\t\t\t\tbutton.style.opacity = '1.0';\r\n\t\t\t};\r\n\t\t\tbutton.onmouseleave = function () {\r\n\t\t\t\tbutton.style.opacity = '0.5';\r\n\t\t\t};\r\n\t\t\tbutton.onclick = function () {\r\n\t\t\t\tif ( currentSession === null ) {\r\n\t\t\t\t\t// request section with section mode: 'immersive-ar', see https://developer.mozilla.org/en-US/docs/Web/API/XRSystem/requestSession\r\n\t\t\t\t\t// onSessionStarted will receive a section as result. \r\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-ar', sessionInit ).then( onSessionStarted );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentSession.end();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tfunction disableButton() {\r\n\t\t\tbutton.style.display = '';\r\n\t\t\tbutton.style.cursor = 'auto';\r\n\t\t\tbutton.style.right = '20px';\r\n\t\t\tbutton.style.width = '150px';\r\n\t\t\tbutton.onmouseenter = null;\r\n\t\t\tbutton.onmouseleave = null;\r\n\t\t\tbutton.onclick = null;\r\n\t\t}\r\n\t\tfunction showARNotSupported() {\r\n\t\t\tdisableButton();\r\n\t\t\tbutton.textContent = 'XR NOT SUPPORTED';\r\n\t\t}\r\n\t\tfunction stylizeElement( element ) {\r\n\t\t\telement.style.position = 'absolute';\r\n\t\t\telement.style.bottom = '20px';\r\n\t\t\telement.style.padding = '12px 6px';\r\n\t\t\telement.style.border = '1px solid #fff';\r\n\t\t\telement.style.borderRadius = '4px';\r\n\t\t\telement.style.background = '#fff';\r\n\t\t\telement.style.color = '#333';\r\n\t\t\telement.style.font = 'normal 13px sans-serif';\r\n\t\t\telement.style.textAlign = 'center';\r\n\t\t\telement.style.opacity = '0.5';\r\n\t\t\telement.style.outline = 'none';\r\n\t\t\telement.style.zIndex = '10001';\r\n\t\t}\r\n\r\n\t\tif ( 'xr' in navigator ) {\r\n\t\t\tbutton.id = 'ARButton';\r\n\t\t\tbutton.style.display = 'none';\r\n\t\t\tstylizeElement( button );\r\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-ar' ).then( function ( supported ) {\r\n\t\t\t\tsupported ? showStartAR() : showARNotSupported();\r\n\t\t\t} ).catch( showARNotSupported );\r\n\t\t\treturn button;\r\n\t\t} else {\r\n\t\t\tconst message = document.createElement( 'a' );\r\n\t\t\t// isSecureContext dùng để check https or http, nếu là https => return true;\r\n\t\t\tif ( window.isSecureContext === false ) {\r\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\r\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\r\n\t\t\t} else {\r\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\r\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\r\n\t\t\t}\r\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\r\n\t\t\tmessage.style.width = '180px';\r\n\t\t\tmessage.style.textDecoration = 'none';\r\n\t\t\tstylizeElement( message );\r\n\t\t\treturn message;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { ARButton };\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.Fragment>\r\n    <App />\r\n  </React.Fragment>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}