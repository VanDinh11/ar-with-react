{"version":3,"sources":["App.js","jsm/webxr/ARButton.js","index.js"],"names":["container","camera","scene","renderer","reticle","current_object","controls","shadow_plane","groupModel","touchDown","touchX","touchY","deltaX","arToolkitSource","ARButton","sessionInit","onEnd","button","document","createElement","showStartAR","currentSession","activeSession","onSessionStarted","session","addEventListener","onSessionEnded","xr","setReferenceSpaceType","setSession","textContent","removeEventListener","style","display","cursor","right","width","backgroundColor","onmouseenter","opacity","onmouseleave","onclick","navigator","requestSession","then","end","disableButton","showARNotSupported","stylizeElement","element","position","bottom","padding","border","borderRadius","background","color","font","textAlign","outline","zIndex","id","isSessionSupported","supported","catch","message","window","isSecureContext","href","location","replace","innerHTML","left","textDecoration","hitTestSource","hitTestSourceRequested","enableUI","App","useState","mode","showIntro","setShowIntro","arPlaceObject","visible","setFromMatrixPosition","matrix","onWindowResize","aspect","innerWidth","innerHeight","updateProjectionMatrix","setSize","loadModel","url","remove","getElementById","GLTFLoader","setPath","load","gltf","traverse","node","isMesh","castShadow","geometry","THREE","rotateX","Math","PI","material","depthWrite","receiveShadow","add","box","setFromObject","getCenter","target","update","render","animateBasic","requestAnimationFrame","ready","arToolkitContext","domElement","timestamp","frame","referenceSpace","getReferenceSpace","getSession","requestReferenceSpace","requestHitTestSource","space","source","hitTestResults","getHitTestResults","length","hit","fromArray","getPose","transform","useEffect","console","log","directionalLight","set","shadow","top","ambientLight","createLighting","antialias","alpha","setClearColor","setPixelRatio","devicePixelRatio","outputEncoding","shadowMap","enabled","type","appendChild","OrbitControls","minDistance","maxDistance","options","requiredFeatures","optionalFeatures","domOverlay","root","createButton","addARButton","matrixAutoUpdate","rotateObject","rotation","y","e","preventDefault","touches","pageX","pageY","addRotateModel","setAnimationLoop","height","overflow","className","onClick","fontSize","hideButton","scale","x","z","ReactDOM","Fragment"],"mappings":"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","file":"static/js/main.d254e645.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport * as THREE from \"three\";\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader.js';\r\nimport { RoughnessMipmapper } from 'three/examples/jsm/utils/RoughnessMipmapper.js';\r\nimport './loader.css';\r\nimport { ARButton } from './jsm/webxr/ARButton';\r\n// import './jsartoolkit5/artoolkit.api';\r\n// import './jsartoolkit5/artoolkit.min.js';\r\n// import './threex/threex-artoolkitsource';\r\n// import './threex/threex-artoolkitcontext';\r\n// import './threex/threex-arbasecontrols';\r\n// import './threex/threex-armarkercontrols';\r\n\r\n/**\r\n * nén file gltf:\r\n * dùng flag -d khi convert\r\n * https://github.com/CesiumGS/gltf-pipeline\r\n */\r\n\r\nlet container;\r\nlet camera, scene, renderer;\r\n\r\nlet reticle, current_object, controls, shadow_plane, groupModel;\r\n\r\nlet hitTestSource = null;\r\nlet hitTestSourceRequested = false;\r\nlet enableUI = true;\r\n\r\nlet touchDown, touchX, touchY, deltaX, deltaY;\r\n\r\nlet arToolkitSource, arToolkitContext;\r\nlet markerRoot1, markerRoot2;\r\n\r\nlet currentSession = null;\r\nlet sessionInit = null;\r\nlet activeSession = 'none-session';\r\n\r\n// const pathModel = 'ar-with-react/3d/'; // local\r\nconst pathModel = '3d/'; // build\r\n\r\nconst App = () => {\r\n    const [mode, setMode] = useState(1); \r\n    const [showIntro, setShowIntro] = useState(true);\r\n    /**\r\n     * 0: arToolkit enable, detect marker\r\n     * 1: detect plane\r\n     */\r\n\r\n    useEffect(() => {\r\n        console.log('new update 18');\r\n        init();\r\n        // \r\n        switch (mode) {\r\n            case 0:\r\n                animateBasic();\r\n                break;\r\n            case 1:\r\n                animateWithXR();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }, [])\r\n\r\n    function init() {\r\n        container = document.getElementById('container');\r\n        scene = new THREE.Scene();\r\n\r\n        createCamera();\r\n        createLighting();\r\n        createRenderer();\r\n        createControl();\r\n\r\n        addARButton();\r\n        addReticle();\r\n\r\n        addRotateModel();\r\n        // arToolkitSourceSetup();\r\n\r\n        window.addEventListener('resize', onWindowResize, false);\r\n\r\n        document.getElementById('ARButton').addEventListener('click', function () {\r\n\t\t\tif(groupModel) groupModel.visible = false;\r\n        })\r\n    }\r\n    \r\n    //////////////////////////////////////////\r\n    // Document Event  ///////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function openNav(e) {\r\n        e.preventDefault();\r\n        document.getElementById(\"mySidenav\").style.width = \"250px\";\r\n    }\r\n\r\n    function closeNav(e) {\r\n        e.preventDefault();\r\n        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n    }\r\n\r\n    function arPlaceObject() {\r\n        if (reticle.visible) {\r\n            groupModel.position.setFromMatrixPosition(reticle.matrix);\r\n            groupModel.visible = true;\r\n        }\r\n    }\r\n\r\n    ////////////////////////////////////////////\r\n    // ARButton ////////////////////////////////\r\n    ////////////////////////////////////////////\r\n\r\n    // function checkXRSupport() {\r\n    //     let message = '';\r\n    //     if ( 'xr' in navigator ) {\r\n\t// \t\tnavigator.xr.isSessionSupported( 'immersive-ar' ).then( function ( supported ) {\r\n    //             supported ? showStartAR() : showARNotSupported();\r\n    //             if(supported) message = 'supported';\r\n    //             else message = 'not-supported';\r\n\t// \t\t} ).catch( () => {\r\n    //             message = 'not-supported';\r\n    //         } );\r\n\t// \t} else {\r\n\t// \t\tif ( window.isSecureContext === false ) {\r\n\t// \t\t\tmessage = 'not-https';\r\n\t// \t\t} else {\r\n\t// \t\t\tmessage = 'not-available';\r\n\t// \t\t}\r\n    //     }\r\n        \r\n    //     return message;\r\n    // }\r\n\r\n    // function showStartAR( /*device*/ ) {\r\n        \r\n    //     function onSessionStarted( session ) {\r\n    //         session.addEventListener( 'end', onSessionEnded );\r\n    //         renderer.xr.setReferenceSpaceType( 'local' );\r\n    //         renderer.xr.setSession( session );\r\n    //         currentSession = session;\r\n    //         activeSession = 'has-session';\r\n    //     }\r\n\r\n    //     function onSessionEnded( /*event*/ ) {\r\n    //         currentSession.removeEventListener( 'end', onSessionEnded );\r\n    //         activeSession = 'none-session';\r\n    //     }\r\n    //     button.onclick = function () {\r\n    //         if ( activeSession === 'none-session' ) {\r\n    //             // request section with section mode: 'immersive-ar', see https://developer.mozilla.org/en-US/docs/Web/API/XRSystem/requestSession\r\n    //             // onSessionStarted will receive a section as result. \r\n    //             navigator.xr.requestSession( 'immersive-ar', sessionInit ).then( onSessionStarted );\r\n    //         } else {\r\n    //             currentSession.end();\r\n    //         }\r\n    //     };\r\n    // }\r\n\r\n    function showARNotSupported() {\r\n\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Init Scene ////////////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function createCamera () {\r\n        camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.001, 200);\r\n    }\r\n\r\n    function createRenderer () {\r\n        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\n        // , logarithmicDepthBuffer: true \r\n        renderer.setClearColor(new THREE.Color('lightgrey'), 0);\r\n        renderer.setPixelRatio(window.devicePixelRatio);\r\n        renderer.setSize(window.innerWidth, window.innerHeight);\r\n        // THREE.GammaEncoding // fix object model too dark\r\n        renderer.outputEncoding = THREE.sRGBEncoding; // fix object model too dark\r\n        // renderer.gammaFactor = 2.2;\r\n        renderer.shadowMap.enabled = true;\r\n        renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        // renderer.shadowMap.type = THREE.PCFShadowMap;\r\n        if(mode === 1) {\r\n            renderer.xr.enabled = true;\r\n        }\r\n        \r\n        container.appendChild(renderer.domElement);\r\n    }\r\n\r\n    function createLighting () {\r\n        var directionalLight = new THREE.DirectionalLight(0xdddddd, 0.5);\r\n        directionalLight.position.set(0, 5, -1);\r\n        // thu hẹp camera lại càng ít (> 0) thì shadow sẽ càng sharp hơn.\r\n        directionalLight.shadow.camera.left = -3;\r\n        directionalLight.shadow.camera.right = 3;\r\n        directionalLight.shadow.camera.top = -3;\r\n        directionalLight.shadow.camera.bottom = 3;\r\n        directionalLight.castShadow = true;\r\n        scene.add(directionalLight);\r\n\r\n        var ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\r\n        // ambientLight.position.set(0, 2, -1);\r\n        scene.add(ambientLight);\r\n\r\n        // const helper = new THREE.CameraHelper( directionalLight.shadow.camera );\r\n        // scene.add( helper );\r\n    }\r\n\r\n    function createControl () {\r\n        controls = new OrbitControls(camera, renderer.domElement);\r\n        controls.addEventListener('change', render);\r\n\r\n        controls.minDistance = 2;\r\n        controls.maxDistance = 10;\r\n        controls.target.set(0, 0, 0);\r\n    }\r\n\r\n    function addARButton () {\r\n        var options = {\r\n            requiredFeatures: ['hit-test'],\r\n            optionalFeatures: ['dom-overlay']\r\n        }\r\n\r\n        options.domOverlay = { root: document.getElementById('ui-content') };\r\n        let uiContent = document.getElementById('ui-content');\r\n        uiContent.appendChild(ARButton.createButton(renderer, options, () => {\r\n            groupModel.visible = true;\r\n        }));\r\n    }\r\n\r\n    function addReticle () { // ring cursor for detection\r\n        reticle = new THREE.Mesh(\r\n            new THREE.RingBufferGeometry(0.015, 0.02, 32).rotateX(- Math.PI / 2),\r\n            new THREE.MeshBasicMaterial()\r\n        );\r\n        reticle.matrixAutoUpdate = false;\r\n        reticle.visible = false;\r\n        scene.add(reticle);\r\n    }\r\n\r\n    function arToolkitSourceSetup () {\r\n        // arToolkitSource = new THREEx.ArToolkitSource({\r\n        //     sourceType : 'webcam',\r\n        // });\r\n    \r\n        // arToolkitSource.init(function onReady(){\r\n        //     onWindowResize()\r\n        // });\r\n    }\r\n\r\n    function onWindowResize() {\r\n\r\n        camera.aspect = window.innerWidth / window.innerHeight;\r\n        camera.updateProjectionMatrix();\r\n\r\n        renderer.setSize(window.innerWidth, window.innerHeight);\r\n\r\n        // if(arToolkitSource) {\r\n        //     arToolkitSource.onResize()\t\r\n        //     arToolkitSource.copySizeTo(renderer.domElement)\t\r\n        //     if ( arToolkitContext.arController !== null )\r\n        //     {\r\n        //         arToolkitSource.copySizeTo(arToolkitContext.arController.canvas)\t\r\n        //     }\r\n        // }\r\n\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Model handling ////////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function loadModel(url) {\r\n        if (groupModel) {\r\n            scene.remove(groupModel);\r\n        }\r\n\r\n        document.getElementById('loader-model').style.display = 'block';\r\n        new GLTFLoader()\r\n            .setPath(pathModel) // path luôn được xác định từ folder chứa index.html\r\n            .load(url, function (gltf) {\r\n                current_object = gltf.scene;\r\n\r\n                // console.log(current_object.children[0].children);\r\n                // current_object.children[0].children[0].material.metalness = 0;\r\n                // current_object.children[0].children[1].material.metalness = 0;\r\n\r\n                current_object.traverse(function (node) { // cast shadow trên từng thành phần của model\r\n                    if ( node.isMesh ) { \r\n                        node.castShadow = true;\r\n                    }\r\n                })\r\n\r\n                let geometry = new THREE.PlaneBufferGeometry(20, 20);\r\n                geometry.rotateX( - Math.PI / 2 );\r\n                let material = new THREE.ShadowMaterial({ color: 0x000000 });\r\n                material.opacity = 0.5;\r\n                material.depthWrite = false;\r\n                shadow_plane = new THREE.Mesh(geometry, material);\r\n                shadow_plane.receiveShadow = true;\r\n\r\n                groupModel = new THREE.Group();\r\n                groupModel.add(current_object);\r\n                groupModel.add(shadow_plane);\r\n\r\n                scene.add(groupModel);\r\n\r\n                var box = new THREE.Box3();\r\n                box.setFromObject(groupModel);\r\n                box.getCenter(controls.target);\r\n                arPlaceObject();\r\n\r\n                document.getElementById('loader-model').style.display = 'none';\r\n                document.getElementById('ARButton').style.display = 'block';\r\n\r\n                controls.update();\r\n                \r\n                setShowIntro(false);\r\n                render();\r\n            });\r\n    }\r\n\r\n    function addRotateModel () {\r\n        renderer.domElement.addEventListener('touchstart', function (e) {\r\n            e.preventDefault();\r\n            touchDown = true;\r\n            touchX = e.touches[0].pageX;\r\n            touchY = e.touches[0].pageY;\r\n        }, false)\r\n        renderer.domElement.addEventListener('touchend', function (e) {\r\n            e.preventDefault();\r\n            touchDown = false;\r\n        }, false)\r\n        renderer.domElement.addEventListener('touchmove', function (e) {\r\n            e.preventDefault();\r\n\r\n            if (!touchDown) return;\r\n\r\n            deltaX = e.touches[0].pageX - touchX;\r\n            deltaY = e.touches[0].pageY - touchY;\r\n            touchX = e.touches[0].pageX;\r\n            touchY = e.touches[0].pageY;\r\n\r\n            rotateObject();\r\n        }, false)\r\n\r\n        function rotateObject() {\r\n            if (groupModel && reticle && hitTestSource) {\r\n                groupModel.rotation.y += deltaX / 100;\r\n            }\r\n        }\r\n    }\r\n\r\n    //////////////////////////////////////////\r\n    // Update and Animate ////////////////////\r\n    //////////////////////////////////////////\r\n\r\n    function animateBasic () {\r\n        requestAnimationFrame(animateBasic);\r\n        if ( arToolkitSource.ready !== false )\r\n            arToolkitContext.update( arToolkitSource.domElement );\r\n        \r\n        render(); // not pass param in order to render normally.\r\n    }\r\n\r\n    function animateWithXR() {\r\n        renderer.setAnimationLoop(render);\r\n    }\r\n\r\n    function render(timestamp, frame) {\r\n        // if has param, it's used with XR, otherwise, it renders normally.\r\n        if (frame) {\r\n            const referenceSpace = renderer.xr.getReferenceSpace();\r\n            const session = renderer.xr.getSession();\r\n\r\n            if (hitTestSourceRequested === false) {\r\n                session.requestReferenceSpace('viewer').then(function (referenceSpace) {\r\n                    session.requestHitTestSource({ space: referenceSpace }).then(function (source) {\r\n                        hitTestSource = source;\r\n                    });\r\n                });\r\n\r\n                session.addEventListener('end', function () {\r\n                    hitTestSourceRequested = false;\r\n                    hitTestSource = null;\r\n\r\n                    reticle.visible = false;\r\n                    var box = new THREE.Box3();\r\n                    box.setFromObject(groupModel);\r\n                    box.getCenter(controls.target);\r\n\r\n                    document.getElementById('place-button').style.display = 'none';\r\n                    document.getElementById('group-zoom').style.display = 'none';\r\n\r\n                });\r\n                hitTestSourceRequested = true;\r\n            }\r\n\r\n            if (hitTestSource) {\r\n                const hitTestResults = frame.getHitTestResults(hitTestSource);\r\n                if (hitTestResults.length) {\r\n                    const hit = hitTestResults[0];\r\n                    document.getElementById('group-zoom').style.display = 'block';\r\n                    if(enableUI) {\r\n                        document.getElementById('place-button').style.display = 'block';\r\n                        document.getElementById('zoom-in-button').style.display = 'block';\r\n                        document.getElementById('zoom-out-button').style.display = 'block';\r\n                        document.getElementById('ARButton').style.display = 'block';\r\n                        reticle.visible = true;\r\n                    }\r\n                    else{\r\n                        document.getElementById('place-button').style.display = 'none';\r\n                        document.getElementById('zoom-in-button').style.display = 'none';\r\n                        document.getElementById('zoom-out-button').style.display = 'none';\r\n                        document.getElementById('ARButton').style.display = 'none';\r\n                        reticle.visible = false;\r\n                    }\r\n                    reticle.matrix.fromArray(hit.getPose(referenceSpace).transform.matrix);\r\n                } else {\r\n                    enableUI = true; // mở lại UI khi mất detect floor.\r\n                    document.getElementById('place-button').style.display = 'none';\r\n                    document.getElementById('zoom-in-button').style.display = 'none';\r\n                    document.getElementById('zoom-out-button').style.display = 'none';\r\n                    document.getElementById('ARButton').style.display = 'none';\r\n                    reticle.visible = false;\r\n                }\r\n            }\r\n        }\r\n        renderer.render(scene, camera);\r\n    }\r\n\r\n    return (\r\n        <div style={{ width: '100%', height: '100%', overflow: 'hidden' }}>\r\n            <div className=\"wrap-intro\" style={{display: showIntro ? 'flex' : 'none'}}>\r\n                <p>Select an item then press \"Start XR\"</p>\r\n                <p>You need to scan the floor until a ring appears on your screen.</p>\r\n            </div>\r\n            <div id=\"ui-content\">\r\n                <div id=\"mySidenav\" className=\"sidenav\">\r\n                    <a href=\"#\" className=\"closebtn\" onClick={closeNav}>×</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('old_sofa_free.glb');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Sofa</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('eames_lounge_chair.gltf');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Lounge Chair</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('lamp.glb');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Lamp</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('antique_iron_safe_v2.glb');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Iron Safe</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('vintage_telephone.gltf');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Telephone</a>\r\n                    <a className=\"ar-object\" href=\"#\" onClick={(e) => {\r\n                        e.preventDefault();\r\n                        loadModel('wooden_chair_low_poly.glb');\r\n                        document.getElementById(\"mySidenav\").style.width = \"0\";\r\n                    }}>Wooden Chair</a>\r\n                </div>\r\n                <span className=\"buttonMenu\" style={{ fontSize: '30px', cursor: 'pointer' }} onClick={openNav}>☰</span>\r\n                <button type=\"button\" id=\"place-button\" onClick={arPlaceObject}>PLACE</button>\r\n                <div id=\"group-zoom\">\r\n                    <button id=\"hide-button\" type=\"button\"\r\n                        onClick={() => {\r\n                            let hideButton = document.getElementById('hide-button');\r\n                            enableUI = !enableUI;\r\n                            if(enableUI) hideButton.innerHTML = 'Hide UI';\r\n                            else hideButton.innerHTML = 'Show UI';\r\n                        }}\r\n                    >Hide UI</button>\r\n                    <button id=\"zoom-in-button\" type=\"button\" \r\n                        onClick={() => {\r\n                            if(groupModel && reticle.visible) {\r\n                                groupModel.scale.x += 0.1;\r\n                                groupModel.scale.y += 0.1;\r\n                                groupModel.scale.z += 0.1;\r\n                            }\r\n                        }}\r\n                    >+</button>\r\n                    <button id=\"zoom-out-button\" type=\"button\"\r\n                        onClick={() => {\r\n                            if (groupModel && reticle.visible && groupModel.scale.x > 0.2 && groupModel.scale.y > 0.2 && groupModel.scale.z > 0.2) {\r\n                                groupModel.scale.x -= 0.1;\r\n                                groupModel.scale.y -= 0.1;\r\n                                groupModel.scale.z -= 0.1;\r\n                            }\r\n                        }}\r\n                    >-</button>\r\n                </div>\r\n                <div id=\"container\" style={{ position: 'fixed' }}>\r\n                </div>\r\n                <div id=\"loader-model\"><div className=\"lds-circle\"><div></div></div></div>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","class ARButton {\r\n\tstatic createButton( renderer, sessionInit = {}, onEnd ) {\r\n\t\tconst button = document.createElement( 'button' );\r\n\t\tfunction showStartAR( /*device*/ ) {\r\n\t\t\tlet currentSession = null;\r\n\t\t\tlet activeSession = 'none-session';\r\n\t\t\tfunction onSessionStarted( session ) {\r\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\r\n\t\t\t\trenderer.xr.setReferenceSpaceType( 'local' );\r\n\t\t\t\trenderer.xr.setSession( session );\r\n\t\t\t\t// console.log(renderer.xr);\r\n\t\t\t\t// console.log(session);\r\n\t\t\t\tbutton.textContent = 'Buy now';\r\n\t\t\t\tcurrentSession = session;\r\n\t\t\t\tactiveSession = 'has-session';\r\n\t\t\t}\r\n\r\n\t\t\tfunction onSessionEnded( /*event*/ ) {\r\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\r\n\t\t\t\tbutton.textContent = 'Start XR';\r\n\t\t\t\tactiveSession = 'none-session';\r\n\t\t\t\tonEnd();\r\n\t\t\t\t// currentSession = null;\r\n\t\t\t}\r\n\r\n\t\t\tbutton.style.display = 'none';\r\n\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\tbutton.style.right = '20px';\r\n\t\t\tbutton.style.width = '100px';\r\n\t\t\tbutton.style.backgroundColor = '#fff';\r\n\t\t\tbutton.textContent = 'Start XR';\r\n\t\t\tbutton.onmouseenter = function () {\r\n\t\t\t\tbutton.style.opacity = '1.0';\r\n\t\t\t};\r\n\t\t\tbutton.onmouseleave = function () {\r\n\t\t\t\tbutton.style.opacity = '0.5';\r\n\t\t\t};\r\n\t\t\tbutton.onclick = function () {\r\n\t\t\t\tif ( activeSession === 'none-session' ) {\r\n\t\t\t\t\t// request section with section mode: 'immersive-ar', see https://developer.mozilla.org/en-US/docs/Web/API/XRSystem/requestSession\r\n\t\t\t\t\t// onSessionStarted will receive a section as result. \r\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-ar', sessionInit ).then( onSessionStarted );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentSession.end();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tfunction disableButton() {\r\n\t\t\tbutton.style.display = '';\r\n\t\t\tbutton.style.cursor = 'auto';\r\n\t\t\tbutton.style.right = '20px';\r\n\t\t\tbutton.style.width = '150px';\r\n\t\t\tbutton.onmouseenter = null;\r\n\t\t\tbutton.onmouseleave = null;\r\n\t\t\tbutton.onclick = null;\r\n\t\t}\r\n\t\tfunction showARNotSupported() {\r\n\t\t\tdisableButton();\r\n\t\t\tbutton.textContent = 'XR NOT SUPPORTED';\r\n\t\t}\r\n\t\tfunction stylizeElement( element ) {\r\n\t\t\telement.style.position = 'fixed';\r\n\t\t\telement.style.bottom = '20px';\r\n\t\t\telement.style.padding = '12px 6px';\r\n\t\t\telement.style.border = '1px solid #fff';\r\n\t\t\telement.style.borderRadius = '4px';\r\n\t\t\telement.style.background = '#fff';\r\n\t\t\telement.style.color = '#333';\r\n\t\t\telement.style.font = 'normal 13px sans-serif';\r\n\t\t\telement.style.textAlign = 'center';\r\n\t\t\telement.style.opacity = '0.5';\r\n\t\t\telement.style.outline = 'none';\r\n\t\t\telement.style.zIndex = '10001';\r\n\t\t}\r\n\r\n\t\tif ( 'xr' in navigator ) {\r\n\t\t\tbutton.id = 'ARButton';\r\n\t\t\tbutton.style.display = 'none';\r\n\t\t\tstylizeElement( button );\r\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-ar' ).then( function ( supported ) {\r\n\t\t\t\tsupported ? showStartAR() : showARNotSupported();\r\n\t\t\t} ).catch( showARNotSupported );\r\n\t\t\treturn button;\r\n\t\t} else {\r\n\t\t\tconst message = document.createElement( 'a' );\r\n\t\t\t// isSecureContext dùng để check https or http, nếu là https => return true;\r\n\t\t\tif ( window.isSecureContext === false ) {\r\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\r\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\r\n\t\t\t} else {\r\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\r\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\r\n\t\t\t}\r\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\r\n\t\t\tmessage.style.width = '180px';\r\n\t\t\tmessage.style.textDecoration = 'none';\r\n\t\t\tstylizeElement( message );\r\n\t\t\treturn message;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { ARButton };\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.Fragment>\r\n    <App />\r\n  </React.Fragment>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}